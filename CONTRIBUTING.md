# Contributing to OXA

## Prerequisites

- [Node.js](https://nodejs.org/) (v22+)
- [pnpm](https://pnpm.io/) (v9+)
- [uv](https://docs.astral.sh/uv/) (for Python package management)

## Setup

```bash
# Install dependencies
pnpm install
```

## Schema Development

The OXA schema is defined as individual YAML files in the `schema/` directory. YAML was chosen for schema definitions because it is more human-readable and easier to edit than JSON.

The `schema/schema.json` file is **autogenerated** from the YAML sources and should not be edited directly. Any schema changes should be made to the `.yaml` files, then regenerated:

```bash
pnpm codegen json
```

## Development Scripts

### Formatting

```bash
# Format all files
pnpm format

# Check formatting without modifying files
pnpm format:check
```

### Linting

```bash
# Check for lint issues
pnpm lint

# Auto-fix lint issues
pnpm lint:fix
```

### Type Checking

```bash
# Run TypeScript type checking
pnpm typecheck
```

### Code Generation

```bash
# Run all code generation (validate, ts, py, rs, docs)
pnpm codegen all

# Or run individual steps:
pnpm codegen validate  # Validate schema files
pnpm codegen ts        # Generate TypeScript types
pnpm codegen py        # Generate Python Pydantic models
pnpm codegen rs        # Generate Rust types
pnpm codegen docs      # Generate MyST documentation
```

### Building

```bash
# Build all packages (uses Turborepo for caching and parallel execution)
pnpm build

# Clean all packages
pnpm clean
```

**Note:** This project uses [Turborepo](https://turbo.build/) for build orchestration. Turborepo provides intelligent caching and parallel task execution across the monorepo, significantly speeding up builds and tests.

## Releases

This project uses [Changesets](https://github.com/changesets/changesets) for version management and releases.

### Adding a changeset

When you make changes that should be released, run:

```bash
pnpm changeset
```

This will prompt you to:
1. Select which packages are affected
2. Choose the bump type (patch, minor, major)
3. Write a summary of the changes

Commit the generated changeset file with your PR.

### Release process

1. When PRs with changesets are merged to `main`, a "Version Packages" PR is automatically created/updated
2. Merging the "Version Packages" PR triggers the release workflow
3. Packages are published to:
   - **npm**: `oxa-types`, `@oxa/core`, `oxa`
   - **PyPI**: `oxa-types`
   - **crates.io**: `oxa-types`

### Version synchronization

- `oxa-types` (TypeScript), `oxa-types` (Python), and `oxa-types` (Rust) stay in sync
- `@oxa/core` and `oxa` can version independently

## Documentation

The documentation uses [MyST](https://mystmd.org) and requires the automated codegen tool to run. To start the documentation use `npm install -g mystmd` and run `myst start` in the `docs/` folder. The online documentation is hosted using Curvenote under https://oxa.dev
